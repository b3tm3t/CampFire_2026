<script>
    // 1. Always define Classes first
    class Player {
        constructor(x, y, size, color){
            this.x = x;
            this.y = y;
            this.size = size;
            this.color = color;
            this.speed = 7;
        }
        draw(){
            ctx.fillStyle = this.color;
            ctx.fillRect(this.x, this.y, this.size, this.size);
        }
    }

    // 2. Select your HTML elements
    const myButton = document.getElementById('startBtn');
    const myTitle = document.getElementById('message');
    const mainCanvas = document.getElementById('gameCanvas');
    const ctx = mainCanvas.getContext('2d');

    // 3. Now you can create the 'worm' because 'Player' is defined
    const worm = new Player(400, 300, 30, "#2ecc71"); // Added # here
    const keys = {};

    // 4. Input listeners
    window.addEventListener('keydown', (e) => { keys[e.key] = true; });
    window.addEventListener('keyup', (e) => { keys[e.key] = false; });

    // 5. The Game Loop function
    function gameLoop(){
        ctx.clearRect(0, 0, mainCanvas.width, mainCanvas.height);
        
        if(keys['w'] || keys['ArrowUp']) worm.y -= worm.speed;
        if(keys['s'] || keys['ArrowDown']) worm.y += worm.speed;
        if(keys['a'] || keys['ArrowLeft']) worm.x -= worm.speed;
        if(keys['d'] || keys['ArrowRight']) worm.x += worm.speed;
        
        worm.draw();
        requestAnimationFrame(gameLoop);
    }

    // 6. The Button Click
    myButton.addEventListener('click', () => {
        myButton.style.display = 'none';
        mainCanvas.width = 800; // Adjusted for better fit
        mainCanvas.height = 600;
        mainCanvas.style.display = 'block';
        gameLoop();
    });
</script>